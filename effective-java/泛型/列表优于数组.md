# 列表优于数组
#Java 

数组与泛型相比，有两个重要的不同。

首先，第一个区别是：数组是协变的，即如果 `Sub` 是 `Super` 的子类型，那么数组类型 `Sub[]` 就是 `Super[]` 的子类型。而泛型是可变的，对于任意两个不同的类型 `Type1` 和 `Type2`，`List<Type1>` 即不是 `List<Type2>` 的子类型，也不是 `List<Type2>` 的超类型。

其次，第二个区别是：数组是具体化的，可在运行时知道和强化它们的元素类型。而泛型是通过擦除来实现的，只在编译时强化它们的类型信息，并在运行时丢弃它们的元素类型。

## 泛型数组非法

由于上述的这些根本区别，因此数组和泛型不能很好的混合使用。因此对于 `new E[]` 这类泛型数组的创建都不是合法的，因为这在编译时都会导致一个泛型数组创建错误。

创建泛型数组非法的原因在于，它不是类型安全的。要是它合法，编译器在其他正确的程序中发生的转换就会在运行时失败，并出现一个 `ClassCastException` 异常。这就违背了泛型系统提供的基本保证。

例如：

```java
List<String>[] stringLists = new List<>[1];
List<Integer> intList = List.of(42);
Object[] objects = stringLists;
objects[0] = intList;
String s = stringLists[0].get(0); // 出现 ClassCastException 异常
```

从技术的角度说，像 `E`、`List<E>` 和 `List<String>` 这样的类型应称为**不可具体化的类型**。直观地说，不可具体化的类型是指其运行时表示法包含的信息比它的编译时表示法包含的信息更少的类型。唯一可具体化的参数化类型是无限制的通配符类型，比如 `List<?>` 和 `Map<?>`。虽然不常用，但是创建无限制通配符的数组是合法的。

