# 移除子类
#Refactoring 

子类很有用，它们为数据结构的多样和行为的多态提供支持，它们是针对差异编程的好工具。

## 动机

但是随着软件的演化，子类所支持的变化可能会被搬移到别处，甚至完全去除，这是子类就失去了价值。有时添加子类是为了应对未来的功能，结果构想中功能压根没被构造出来，或者用了另一种方式构造，使该子类不再被需要。

子类存在着就有成本，阅读者要花心思去理解它的用意，所以如果子类的用处太少，就不值得存在了。此时，最好的选择就是移除子类，将其替换为超类中的一个字段。

## 做法

1. 使用[[以工厂函数取代构造函数]]，把子类的构造函数包装到父类的工厂函数中。
2. 如果有任何代码检查子类的类型，先用[[提炼函数]]把类型检查逻辑包装起来，然后用[[搬移函数]]将其搬到父类。每次修改后执行测试。
3. 新建一个字段，用于代表子类的类型。
4. 将原本针对子类的类型做判断的函数改为使用新建的类型字段。
5. 测试子类。
6. 测试。

