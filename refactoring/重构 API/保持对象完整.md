# 保持对象完整
#Refactoring 

函数使用对象尽量完整的使用，而不要仅使用某些参数。

## 动机

如果代码从一个记录结构中导出几个值，然后又把这几个值传递给一个函数，则更愿意把整个记录传给这个函数，在函数体内部导出所需的值。

”传递整个记录“的方式存在以下好处：

1. 将来函数需要从记录中导出更多数据时，无需为此修改参数列表。
2. 可缩短参数列表，让函数调用更容易看懂。

如果很多函数都在使用记录中的同一组数据，且处理部分数据的逻辑常会重复，此时可以把这些处理逻辑搬移到完整对象上。

> 有时也会不想采用该重构手法，因为不想被调用函数依赖完整对象，尤其是在两者不在同一模块中的时候。

从一个对象中抽取几个值，单独对这几个值做某些逻辑操作，这是一种代码坏味道，通常标志这段逻辑应该被搬移到对象中。

> 保持对象完整经常发生在[[引入参数对象]]后。

如果几处代码都在使用对象的一部分功能，可能意味着应该用[[提炼类]]把一部分功能单独提炼出来。

有一种常被忽视的场景是：调用者将自己的若干数据作为参数，传递给被调用的函数。这种情况下，可以将调用者的自我引用作为参数，直接传递给参数。

## 做法

1. 新建一个空函数，给它以期望的参数列表（即传入完整对象作为参数）。
2. 在新函数体内调用旧函数，并把新的参数映射到旧参数列表。
3. 执行静态检查。
4. 逐一修改旧函数的调用者，令其使用新函数，每次修改之后执行测试。
5. 所有调用处都修改过来后，使用内联函数把旧函数内联到新函数体内。
6. 给新函数改名，从重构开始时的容易搜索的临时名字，改为使用旧函数的名字，同时修改所有调用处。