# 提炼变量
#Refactoring 

有时表达式有可能非常复杂。

## 动机

可以通过局部变量将表达式分解为比较容易理解的形式。在面对复杂逻辑时，局部变量使我能给其中的一部分命名，这样就能更好地理解这部分逻辑。

提炼变量在取名时需要考虑名字所处上下文。如果名字只在当前函数中存在意义，提炼变量是不错的选择；但如果在更宽的上下文中也有意义，则会考虑以函数的形式暴露出来。其他代码也可以访问，减少重复。

“将新的名字暴露的更宽”的坏处需要增加额外的工作量。如果工作量很大，可以暂时搁置这个想法，稍后再用[[以查询取代临时变量]]来处理它。

> 如果处理的这段代码属于一个类，对这个新变量使用[[提炼函数]]会很容易。

## 做法

1. 确认要提炼函数的表达式没有副作用。
2. 声明一个不可修改的变量，把你想要提炼的表达式复制一份，以该表达式的结果值给这个变量赋值。
3. 用这个新变量取代原来的表达式。
4. 测试。

如果表达式出现多次，请使用新变量逐一替换，每次替换之后都要执行测试。