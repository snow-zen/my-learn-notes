# 以函数取代命令
#Refactoring 

## 动机

命令对象为处理复杂计算提供了强大的机制。借助命令对象，可以轻松地将原本复杂的函数拆解为多个方法，彼此之间通过字段共享状态。拆解后的方法可以分别调用；开始调用之前的数据状态也可以逐步构建。

但这种强大是有代价的。大多数时候，只是想调用一个函数，让它完成自己的工作就好。如果这个函数不是太复杂，那么命令对象可能显得费而不惠，此时可以考虑变回普通函数。

## 做法

1. 运用[[提炼函数]]，把“创建并执行命令对象”的代码单独提炼到一个函数中。
2. 对命令对象在执行阶段用到的函数，逐一使用[[内联函数]]。
3. 使用[[改变函数声明]]，把构造函数的参数转移到执行函数。
4. 对于所有的字段，在执行函数中找到引用它们的地方，并改为使用参数。每次修改后都要测试。
5. 把“调用构造函数”和“调用执行函数”两步都内联到调用方。
6. 测试。
7. 用[[移除死代码]]把命令类消除。