# 以查询取代参数
#Refactoring 

函数的参数列表应该总结该函数的可变性，标示出函数可能体现出行为差异的主要方式。

## 动机

函数的参数列表应该和任何代码中的语句一样，参数列表应该尽量避免重复，并且参数列表越短越容易理解。

如果函数声明的参数是函数本身就可以获取到的，那么这个参数就是重复的。它会增加客户端调用的难度，因为它需要找出传入的参数。

> 如果函数本身难以承担查询参数的责任，就另当别论了。

对于不使用[[以查询取代参数]]的常见原因是，移除参数会给函数增加不必要的依赖关系，它会迫使函数通过访问某个程序元素，而原本并不像让函数了解到这个元素。这种情况下，都应该慎重考虑使用[[以查询取代参数]]。

如果想要移除的参数是可以通过另一个参数获取到的，那么几乎没有任何理由要同时传递这两个参数。

> 另外需要注意一点：如果在处理的函数具有引用透明性[^1]，这样的函数即容易理解又容易测试，这种优秀的品质是珍贵的。此时不应该去掉它的参数，去访问一个可变的全局变量。

[^1]: 引用透明性：指不论任何时候，只要传入相同的参数值，该函数的行为永远一致。

## 做法

1. 如果有必要，使用[[提炼函数]]将参数的计算过程提炼到一个独立的函数中。
2. 将函数体内引用该参数的地方改为调用新建的函数。每次修改后执行测试。
3. 全部替换完成后，使用[[改变函数声明]]将该参数去掉。