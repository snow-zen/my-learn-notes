# 字段上移
#Refactoring 

## 动机

如果各子类是分别开发的，或者是在重构过程中组合起来的，你常会发现他们拥有重复特性，特别是字段更容易重复。

这样的字段有时拥有近似的名字，但也并非绝对如此。判断若干字段是否重复，唯一的方法就是观察函数如果使用它们。如果使用的方式很相似，就可以将其提升到超类中去。

本项重构可从两方面减少重复：首先它去除了重复的数据声明；其次它可以将使用的字段的行为从子类移至父类，从而去除重复的行为。

> 在许多动态语言中不需要在类定义中定义字段，相反，字段是第一次被赋值的同时完成声明的。这种情况下，[[字段上移]]基本上是应用[[构造函数上移]]后必然结果。

## 做法

1. 针对待提升字段，检查它们的所有使用点，确认它们以同样的方式被使用。
2. 如果这些字段的名称不同，先使用[[变量改名]]为它们取个相同的名字。
3. 在超类中新建一个字段。

> 新字段需要对所有子类可见（在大多数语言中 protected 权限即可）。

4. 移除子类中的字段。
5. 测试。
