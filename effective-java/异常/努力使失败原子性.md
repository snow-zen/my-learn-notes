# 努力使失败原子性
#Java 

当对象抛出异常之后，通常我们希望这个对象仍然保持在一种定义良好的可用状态之中。一般而言，失败的方法调用应该使对象保持在被调用之前的状态。

最简单的办法莫过于设计一个不可变的对象。如果对象是不可变的，则失败原子性就是必然的。而对于在可变对象上，获得失败原子性的方式是：

1. 在执行操作之前，检查参数的有效性。
2. 调整计算处理过程，使任何可能失败的计算部分在对象状态被修改之前发生。
3. 在对象的一份临时拷贝上执行操作，当操作完成之后再用临时拷贝中的结果代替对象的内容。
4. 获得失败原子性的办法远远没有那么常用时，编写一段恢复代码使对象回滚到操作开始前的状态，主要用于永久性的数据结构。

