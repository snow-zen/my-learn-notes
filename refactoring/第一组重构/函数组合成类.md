# 函数组合成类
#Refactoring 

类在大多数编程语言都是基本的构造。它们把数据与函数捆绑到同一个环境中，将一部分数据与函数暴露给其他程序元素以便协作。它们是面向对象语言的首要构造，在其他程序设计方法中也同样有用。

## 动机

如果发现一组函数形影不离地操作同一块数据（通常是将这块数据作为参数传递），那么可以认为是时候组建一个类。

类可以明确给这些函数提供一个共用的环境，在对象内部调用这些函数可以少传许多参数，从而简化函数调用，并且这样一个对象也可以更方便传递给系统的其他部分。

> 除了可以将已有的函数组织起来，该重构手法也给我们一个机会，去发现其他计算逻辑，同时也将其重构到新的类中。

将函数组织到一起的另一种方式是[[函数组合成变换]]。具体使用哪个重构手法，取决于程序整体上下文。使用类有一好处：客户端可以修改对象的核心数据，通过计算得出派生数据则会自动与核心数据保持一致。

额外注意的是，部分编程语言中类不是一等公民，而函数是。在这样的语言中，可以用“[函数作为对象](https://martinfowler.com/bliki/FunctionAsObject.html)”的形式实现该重构手法。

## 做法

1. 运用[[封装记录]]对多个函数共用的数据记录加以封装。

> 如果多个函数共用的数据还未组织成记录结构，可先运用[[引入参数对象]]将其组织成记录。

2. 对于使用该记录结构的每个函数，运用[[搬移函数]]将其移入新类中。

> 如果函数调用时传入的参数已经是新类的成员，则可以从参数列表中去除。

3. 用以处理该数据记录的逻辑可以用[[提炼函数]]提炼出来，并移入新类。